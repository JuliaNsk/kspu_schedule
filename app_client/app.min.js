!function(){function e(e,t){e.when("/",{templateUrl:"home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).when("/profile",{templateUrl:"/profile/profile.view.html",controller:"profileCtrl",controllerAs:"vm"}).when("/admin/schedules",{templateUrl:"/schedules/schedules.view.html",controller:"schedulesCtrl",controllerAs:"vm"}).when("/admin/schedule/add-schedule",{templateUrl:"/schedules/add-schedule.view.html",controller:"addScheduleCtrl",controllerAs:"vm"}).when("/schedule/:id",{templateUrl:"/schedules/show-schedule.view.html",controller:"showScheduleCtrl",controllerAs:"vm"}).when("/admin/schedule/:id",{templateUrl:"/schedules/edit-schedule.view.html",controller:"editScheduleCtrl",controllerAs:"vm"}).when("/admin/subjects",{templateUrl:"/subjects/subjects.view.html",controller:"subjectsCtrl",controllerAs:"vm"}).when("/admin/groups",{templateUrl:"/groups/groups.view.html",controller:"groupsCtrl",controllerAs:"vm"}).when("/admin/organizations",{templateUrl:"/organizations/organizations.view.html",controller:"organizationsCtrl",controllerAs:"vm"}).when("/admin/teachers",{templateUrl:"/teachers/teachers.view.html",controller:"teachersCtrl",controllerAs:"vm"}).when("/teacher/schedule/:id",{templateUrl:"/teachers/schedule.view.html",controller:"teachersScheduleCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"}),t.html5Mode(!0)}function t(e,t,n){e.$on("$routeChangeStart",function(e,r,o){"/login"===t.path()||"/register"===!t.path()||n.isLoggedIn()||t.path("/login")})}angular.module("kspuApp",["ngRoute"]),angular.module("kspuApp").config(["$routeProvider","$locationProvider",e]).run(["$rootScope","$location","authentication",t])}(),function(){function e(e,t,n){function r(){e.getGroups().error(function(e){alert(e)}).then(function(e){i.groups=e.data})}function o(){n.getOrganizations().error(function(e){alert(e)}).then(function(e){i.organizations=e.data})}var i=this;i.select="",md.initMinimizeSidebar(),i.newGroup={},r(),o(),i.addModal=function(){$(".selectpicker").selectpicker("refresh").change(function(e){i.select=$(this).find("option:selected").text()})},i.removeGroup=function(n){t.confirm("Ви дійсно бажаєте видалити групу?")&&e.removeGroups(n).then(function(){i.newGroup={},r()})},i.editModal=function(e){$(".selectpicker").selectpicker("refresh").change(function(e){i.select=$(this).find("option:selected").text()}),i.groupData=angular.copy(e),i.groupData.organization=i.organizations.filter(function(e){return e.name==i.select})[0]},i.editGroup=function(){i.groupData.organization=i.organizations.filter(function(e){return e.name==i.select})[0],e.editGroups(i.groupData).then(function(){i.groupData={},r()})},i.addGroup=function(){i.newGroup.organization=i.organizations.filter(function(e){return e.name==i.select})[0],e.addGroups(i.newGroup).error(function(e){alert(e)}).then(function(){i.newGroup={},r()})}}angular.module("kspuApp").controller("groupsCtrl",e),e.$inject=["groups","$window","organizations"]}(),function(){function e(e,t){function n(){e.getOrganizations().error(function(e){alert(e)}).then(function(e){r.organizations=e.data})}var r=this;md.initMinimizeSidebar(),r.newOrganization={},n(),r.removeOrganization=function(o){t.confirm("Ви дійсно бажаєте видалити організацію?")&&e.removeOrganizations(o).then(function(){r.newOrganization={},n()})},r.editModal=function(e){r.organizationData=angular.copy(e)},r.editOrganization=function(){e.editOrganizations(r.organizationData).then(function(){r.organizationData={},n()})},r.addOrganization=function(){e.addOrganizations(r.newOrganization).error(function(e){alert(e)}).then(function(){r.newOrganization={},n()})}}angular.module("kspuApp").controller("organizationsCtrl",e),e.$inject=["organizations","$window","$scope"]}(),function(){function e(){console.log("Home controller is running")}angular.module("kspuApp").controller("homeCtrl",e)}(),function(){function e(e,t,n){var r=this;r.user={},t.getProfile().success(function(e){r.user=e,n.user=e}).error(function(e){console.log(e)})}angular.module("kspuApp").controller("profileCtrl",e),e.$inject=["$location","kspuData","$scope"]}(),function(){function e(e,t,n,r,o,i,a){function c(){i.all([u(),s(),h(),d(),l(),f()])}function u(){t.getSchedules().error(function(e){alert(e)}).then(function(e){p.schedules=e.data})}function s(){n.getOrganizations().error(function(e){alert(e)}).then(function(e){p.organizations=e.data})}function l(){r.getSubjects().error(function(e){alert(e)}).then(function(e){p.subjects=e.data,$(".selectpicker").selectpicker("refresh")})}function d(){a.getGroups().error(function(e){alert(e)}).then(function(e){p.groups=e.data,$(".selectpicker").selectpicker("refresh")})}function h(){o.getTeachers().error(function(e){alert(e)}).then(function(e){p.teachers=e.data})}function f(){}var p=this;p.years=[{title:"2015-2016",year:2015},{title:"2016-2017",year:2016},{title:"2017-2018",year:2017}],p.schedule={monday:[],tuesday:[],wednesday:[],thursday:[],friday:[]},md.initMinimizeSidebar(),c(),p.schedules=[],p.createSchedule=function(){console.log(p.schedule),t.addSchedules(p.schedule).error(function(e){alert(e)}).then(function(t){e.path("/admin/schedules")})}}angular.module("kspuApp").controller("addScheduleCtrl",e),e.$inject=["$location","schedules","organizations","subjects","teachers","$q","groups"]}(),function(){function e(e,t,n,r,o,i,a,c){function u(){a.all([s(),l(),f(),d(),h()]).then(p)}function s(){return n.getScheduleById({id:g.currentSchedule}).error(function(e){alert(e)}).then(function(e){g.scheduleData=e.data})}function l(){return r.getOrganizations().error(function(e){alert(e)}).then(function(e){g.organizations=e.data})}function d(){return o.getSubjects().error(function(e){alert(e)}).then(function(e){g.subjects=e.data,g.subjects.push({name:" "})})}function h(){return c.getGroups().error(function(e){alert(e)}).then(function(e){g.groups=e.data,$(".selectpicker").selectpicker("refresh")})}function f(){return i.getTeachers().error(function(e){alert(e)}).then(function(e){g.teachers=e.data,g.teachers.push({name:" "})})}function p(){var e=["monday","tuesday","wednesday","thursday","friday"];$.each(e,function(e,t){$.each(g.scheduleData[t],function(e,t){t&&(t.teacher&&(t.teacher=g.teachers.filter(function(e){return e._id==t.teacher})[0]),t.subject&&(t.subject=g.subjects.filter(function(e){return e._id==t.subject})[0]))}),g.schedule=g.scheduleData})}var g=this;g.years=["2015-2016","2016-2017","2017-2018"],g.currentSchedule=t.id,g.schedule={},g.scheduleData={},g.subjects={},g.groups={},g.teachers={},md.initMinimizeSidebar(),u(),g.editSchedule=function(){$.each(g.schedule.monday,function(e,t){t&&t.teacher&&(t.teacher=t.teacher._id),t&&t.subject&&(t.subject=t.subject._id)}),console.log(g.schedule),n.editSchedules(g.schedule).error(function(e){alert(e)}).then(function(t){e.path("/admin/schedules")})}}angular.module("kspuApp").controller("editScheduleCtrl",e),e.$inject=["$location","$routeParams","schedules","organizations","subjects","teachers","$q","groups"]}(),function(){function e(e,t,n,r){function o(){t.getSchedules().error(function(e){alert(e)}).then(function(e){a.schedules=e.data})}function i(){n.getOrganizations().error(function(e){alert(e)}).then(function(e){a.organizations=e.data})}var a=this;md.initMinimizeSidebar(),o(),i(),a.schedules=[],a.removeSchedule=function(e){r.confirm("Ви дійсно бажаєте видалити розклад?")&&t.removeSchedules(e).then(function(){a.schedules=[],o()})}}angular.module("kspuApp").controller("schedulesCtrl",e),e.$inject=["$location","schedules","organizations","$window"]}(),function(){function e(e,t,n,r,o,i,a,c){function u(){a.all([s(),l(),f(),d(),h()]).then(p)}function s(){return n.getScheduleById({id:g.currentSchedule}).error(function(e){alert(e)}).then(function(e){g.schedule=e.data})}function l(){return r.getOrganizations().error(function(e){alert(e)}).then(function(e){g.organizations=e.data})}function d(){return o.getSubjects().error(function(e){alert(e)}).then(function(e){g.subjects=e.data})}function h(){return c.getGroups().error(function(e){alert(e)}).then(function(e){g.groups=e.data,$(".selectpicker").selectpicker("refresh")})}function f(){return i.getTeachers().error(function(e){alert(e)}).then(function(e){g.teachers=e.data})}function p(){var e=["monday","tuesday","wednesday","thursday","friday"];$.each(e,function(e,t){$.each(g.schedule[t],function(e,t){t&&(t.teacher&&(t.teacher=g.teachers.filter(function(e){return e._id==t.teacher})[0].name),t.subject&&(t.subject=g.subjects.filter(function(e){return e._id==t.subject})[0].name))})})}var g=this;g.years=["2015-2016","2016-2017","2017-2018"],g.currentSchedule=t.id,g.schedule={},g.subjects={},g.groups={},g.teachers={},md.initMinimizeSidebar(),u()}angular.module("kspuApp").controller("showScheduleCtrl",e),e.$inject=["$location","$routeParams","schedules","organizations","subjects","teachers","$q","groups"]}(),function(){function e(e,t,n){function r(){e.getSubjects().error(function(e){alert(e)}).then(function(e){i.subjects=e.data})}function o(){n.getOrganizations().error(function(e){alert(e)}).then(function(e){i.organizations=e.data})}var i=this;md.initMinimizeSidebar(),i.select="",i.newSubject={},r(),o(),i.addModal=function(){$(".selectpicker").selectpicker("refresh").change(function(e){i.select=$(this).find("option:selected").text()})},i.addSubject=function(){i.newSubject.organization=i.organizations.filter(function(e){return e.name==i.select})[0],e.addSubjects(i.newSubject).error(function(e){alert(e)}).then(function(){i.newSubject={},r()})},i.editModal=function(e){$(".selectpicker").selectpicker("refresh").change(function(e){i.select=$(this).find("option:selected").text()}),i.subjectData=angular.copy(e),i.subjectData.organization=i.organizations.filter(function(e){return e.name==i.select})[0]},i.editSubject=function(){i.subjectData.organization=i.organizations.filter(function(e){return e.name==i.select})[0],e.editSubjects(i.subjectData).then(function(){i.subjectData={},r()})},i.removeSubject=function(n){t.confirm("Ви дійсно бажаєте видалити  дисципліну?")&&e.removeSubjects(n).then(function(){i.newSubject={},r()})}}angular.module("kspuApp").controller("subjectsCtrl",e),e.$inject=["subjects","$window","organizations"]}(),function(){function e(e,t,n,r,o,i,a,c){function u(){a.all([s(),l(),f(),d(),h()]).then(p)}function s(){return n.getSchedules().error(function(e){alert(e)}).then(function(e){new Date;g.schedule={monday:[],tuesday:[],wednesday:[],thursday:[],friday:[]},$.each(e.data,function(e,t){2016==t.year&&($.each(t.monday,function(e,n){n&&n.teacher===g.currentTeacher&&(g.schedule.monday[e]=n,g.schedule.monday[e].group=t.group.number)}),$.each(t.tuesday,function(e,n){n&&n.teacher===g.currentTeacher&&(g.schedule.monday[e]=n,g.schedule.monday[e].group=t.group.number)}),$.each(t.wednesday,function(e,n){n&&n.teacher===g.currentTeacher&&(g.schedule.monday[e]=n,g.schedule.monday[e].group=t.group.number)}),$.each(t.thursday,function(e,n){n&&n.teacher===g.currentTeacher&&(g.schedule.monday[e]=n,g.schedule.monday[e].group=t.group.number)}),$.each(t.friday,function(e,n){n&&n.teacher===g.currentTeacher&&(g.schedule.monday[e]=n,g.schedule.monday[e].group=t.group.number)}))})})}function l(){return r.getOrganizations().error(function(e){alert(e)}).then(function(e){g.organizations=e.data})}function d(){return o.getSubjects().error(function(e){alert(e)}).then(function(e){g.subjects=e.data})}function h(){return c.getGroups().error(function(e){alert(e)}).then(function(e){g.groups=e.data,$(".selectpicker").selectpicker("refresh")})}function f(){return i.getTeachers().error(function(e){alert(e)}).then(function(e){g.teachers=e.data})}function p(){var e=["monday","tuesday","wednesday","thursday","friday"];$.each(e,function(e,t){$.each(g.schedule[t],function(e,t){t&&(t.teacher&&(t.teacher=g.teachers.filter(function(e){return e._id==t.teacher})[0].name),t.subject&&(t.subject=g.subjects.filter(function(e){return e._id==t.subject})[0].name))})})}var g=this;g.years=["2015-2016","2016-2017","2017-2018"],g.currentTeacher=t.id,g.schedule={},g.subjects={},g.groups={},g.teachers={},md.initMinimizeSidebar(),u()}angular.module("kspuApp").controller("teachersScheduleCtrl",e),e.$inject=["$location","$routeParams","schedules","organizations","subjects","teachers","$q","groups"]}(),function(){function e(e,t,n,r){function o(){e.getTeachers().error(function(e){alert(e)}).then(function(e){a.teachers=e.data})}function i(){n.getOrganizations().error(function(e){alert(e)}).then(function(e){a.organizations=e.data})}var a=this;a.select="",md.initMinimizeSidebar(),a.newTeacher={},o(),i(),a.removeTeacher=function(n){t.confirm("Ви дійсно бажаєте видалити  дисципліну?")&&e.removeTeachers(n).then(function(){a.newTeacher={},o()})},a.addModal=function(){$(".selectpicker").selectpicker("refresh").change(function(e){a.select=$(this).find("option:selected").text()})},a.editModal=function(e){$(".selectpicker").selectpicker("refresh").change(function(e){a.select=$(this).find("option:selected").text()}),a.teacherData=angular.copy(e),a.teacherData.organization=a.organizations.filter(function(e){return e.name==a.select})[0]},a.editTeacher=function(){a.teacherData.organization=a.organizations.filter(function(e){return e.name==a.select})[0],e.editTeachers(a.teacherData).then(function(){a.teacherData={},o()})},a.addTeacher=function(){a.newTeacher.organization=a.organizations.filter(function(e){return e.name==a.select})[0],e.addTeachers(a.newTeacher).error(function(e){alert(e)}).then(function(){a.newTeacher={},o()})},a.showTeacherSchedule=function(){r.getSchedules().error(function(e){alert(e)}).then(function(e){a.schedule=e.data,console.log(a.schedule)})}}angular.module("kspuApp").controller("teachersCtrl",e),e.$inject=["teachers","$window","organizations","schedules"]}(),function(){function e(e,t){var n=this;n.credentials={email:"",password:""},n.onSubmit=function(){t.login(n.credentials).error(function(e){alert(e)}).then(function(){e.path("profile")})}}angular.module("kspuApp").controller("loginCtrl",e),e.$inject=["$location","authentication"]}(),function(){function e(e,t){var n=this;n.credentials={name:"",email:"",password:""},n.onSubmit=function(){console.log("Submitting registration"),t.register(n.credentials).error(function(e){alert(e)}).then(function(){e.path("profile")})}}angular.module("kspuApp").controller("registerCtrl",e),e.$inject=["$location","authentication"]}(),function(){function e(e,t){var n=function(e){t.localStorage["kspu-token"]=e},r=function(e){t.localStorage["kspu-userData"]=e},o=function(){return t.localStorage["kspu-userData"]},i=function(){return t.localStorage["kspu-token"]},a=function(){var e,n=i();return!!n&&(e=n.split(".")[1],e=t.atob(e),e=JSON.parse(e),e.exp>Date.now()/1e3)},c=function(){if(a()){var e=i(),n=e.split(".")[1];return n=t.atob(n),n=JSON.parse(n),{email:n.email,name:n.name}}};return register=function(t){return e.post("/api/register",t).success(function(e){n(e.token)})},login=function(t){return e.post("/api/login",t).success(function(e){n(e.token),r(e)})},logout=function(){t.localStorage.removeItem("kspu-token")},{currentUser:c,saveToken:n,getUserData:o,setUserData:r,getToken:i,isLoggedIn:a,register:register,login:login,logout:logout}}angular.module("kspuApp").service("authentication",e),e.$inject=["$http","$window"]}(),function(){function e(e,t){var n=function(){return e.get("/api/profile",{headers:{Authorization:"Bearer "+t.getToken()}})};return{getProfile:n}}angular.module("kspuApp").service("kspuData",e),e.$inject=["$http","authentication"]}(),function(){function e(e,t){var n=function(t){return e.post("/api/groups",t)},r=function(){return e.get("/api/groups",{headers:{Authorization:"Bearer "+t.getToken()}})},o=function(t){return e["delete"]("/api/groups/"+t)},i=function(t){return e.put("/api/groups/"+t._id,t)};return{addGroups:n,getGroups:r,removeGroups:o,editGroups:i}}angular.module("kspuApp").service("groups",e),e.$inject=["$http","authentication"]}(),function(){function e(e,t){var n=function(t){return e.post("/api/organizations",t)},r=function(){return e.get("/api/organizations",{headers:{Authorization:"Bearer "+t.getToken()}})},o=function(t){return e["delete"]("/api/organizations/"+t)},i=function(t){return e.put("/api/organizations/"+t._id,t)};return{addOrganizations:n,getOrganizations:r,removeOrganizations:o,editOrganizations:i}}angular.module("kspuApp").service("organizations",e),e.$inject=["$http","authentication"]}(),function(){function e(e,t){var n=function(t){return e.post("/api/schedule",t)},r=function(){return e.get("/api/schedule",{headers:{Authorization:"Bearer "+t.getToken()}})},o=function(t){return e.get("/api/schedule/"+t.id)},i=function(t){return e["delete"]("/api/schedule/"+t)},a=function(t){return e.put("/api/schedule/"+t._id,t)};return{addSchedules:n,getSchedules:r,getScheduleById:o,removeSchedules:i,editSchedules:a}}angular.module("kspuApp").service("schedules",e),e.$inject=["$http","authentication"]}(),function(){function e(e,t){var n=function(t){return e.post("/api/subjects",t)},r=function(){return e.get("/api/subjects",{headers:{Authorization:"Bearer "+t.getToken()}})},o=function(t){return e["delete"]("/api/subjects/"+t)},i=function(t){return e.put("/api/subjects/"+t._id,t)};return{addSubjects:n,getSubjects:r,removeSubjects:o,editSubjects:i}}angular.module("kspuApp").service("subjects",e),e.$inject=["$http","authentication"]}(),function(){function e(e,t){var n=function(t){return e.post("/api/teachers",t)},r=function(){return e.get("/api/teachers",{headers:{Authorization:"Bearer "+t.getToken()}})},o=function(t){return e["delete"]("/api/teachers/"+t)},i=function(t){return e.put("/api/teachers/"+t._id,t)};return{addTeachers:n,getTeachers:r,removeTeachers:o,editTeachers:i}}angular.module("kspuApp").service("teachers",e),e.$inject=["$http","authentication"]}(),function(){function e(e,t){var n=this;n.isLoggedIn=t.isLoggedIn(),n.currentUser=t.currentUser(),n.go=function(t){e.path(t)}}angular.module("kspuApp").controller("navigationCtrl",e),e.$inject=["$location","authentication"]}(),function(){function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}angular.module("kspuApp").directive("navigation",e)}();
//# sourceMappingURL=app.min.js.map
